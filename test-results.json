{"numFailedTestSuites":4,"numFailedTests":39,"numPassedTestSuites":6,"numPassedTests":61,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":2,"numTodoTests":0,"numTotalTestSuites":10,"numTotalTests":100,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1756771835643,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["PIIRedactionService","UK Names Redaction"],"duration":33,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService UK Names Redaction should redact full names with FULL level","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should redact full names with FULL level"},{"ancestorTitles":["PIIRedactionService","UK Names Redaction"],"duration":14,"failureDetails":[{"matcherResult":{"actual":"Contact John Smith for details.","expected":"Contact J*** S*** for details.","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Contact J\u001b[7m*** S***\u001b[27m for details.\"\u001b[39m\nReceived: \u001b[31m\"Contact J\u001b[7mohn Smith\u001b[27m for details.\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Contact J\u001b[7m*** S***\u001b[27m for details.\"\u001b[39m\nReceived: \u001b[31m\"Contact J\u001b[7mohn Smith\u001b[27m for details.\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:33:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Names Redaction should partially redact names with PARTIAL level","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact names with PARTIAL level"},{"ancestorTitles":["PIIRedactionService","UK Names Redaction"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService UK Names Redaction should not redact names with NONE level","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should not redact names with NONE level"},{"ancestorTitles":["PIIRedactionService","UK Names Redaction"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"John Smith and [NAME_REDACTED] are co-defendants.","expected":"[NAME_REDACTED] and [NAME_REDACTED] are co-defendants.","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[NAME_REDACTED]\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mJohn Smith\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[NAME_REDACTED]\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7mJohn Smith\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:49:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Names Redaction should handle multiple names in text","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle multiple names in text"},{"ancestorTitles":["PIIRedactionService","UK National Insurance Numbers"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"NI Number: [NI[SORT_REDACTED]D]","expected":"NI Number: [NI_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"NI Number: [NI_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"NI Number: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"NI Number: [NI_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"NI Number: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:59:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK National Insurance Numbers should redact valid NI numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact valid NI numbers"},{"ancestorTitles":["PIIRedactionService","UK National Insurance Numbers"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService UK National Insurance Numbers should partially redact NI numbers","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should partially redact NI numbers"},{"ancestorTitles":["PIIRedactionService","UK National Insurance Numbers"],"duration":10,"failureDetails":[{"matcherResult":{"actual":"NI: [NI[SORT_REDACTED]D]","expected":"NI: [NI_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"NI: [NI_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"NI: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"NI: [NI_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"NI: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:79:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:77:17)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK National Insurance Numbers should handle NI numbers with different spacing","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should handle NI numbers with different spacing"},{"ancestorTitles":["PIIRedactionService","UK Postcodes"],"duration":26,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService UK Postcodes should redact valid UK postcodes","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should redact valid UK postcodes"},{"ancestorTitles":["PIIRedactionService","UK Postcodes"],"duration":11,"failureDetails":[{"matcherResult":{"actual":"SW1A 1AA","expected":"SWX XXX","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"SW\u001b[7mX XXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"SW\u001b[7m1A 1AA\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"SW\u001b[7mX XXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"SW\u001b[7m1A 1AA\u001b[27m\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:102:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Postcodes should partially redact postcodes","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact postcodes"},{"ancestorTitles":["PIIRedactionService","UK Phone Numbers"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService UK Phone Numbers should redact mobile numbers","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should redact mobile numbers"},{"ancestorTitles":["PIIRedactionService","UK Phone Numbers"],"duration":6,"failureDetails":[{"matcherResult":{"actual":"Office: +44 20 1234 5678","expected":"Office: [PHONE_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Office: \u001b[7m[PHONE_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"Office: \u001b[7m+44 20 1234 5678\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Office: \u001b[7m[PHONE_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"Office: \u001b[7m+44 20 1234 5678\u001b[27m\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:129:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:127:17)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Phone Numbers should redact landline numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact landline numbers"},{"ancestorTitles":["PIIRedactionService","UK Phone Numbers"],"duration":3,"failureDetails":[{"matcherResult":{"actual":"+44 7123 456789","expected":"+44 XXXX XXXXXX","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"+44 \u001b[7mXXXX XXXXXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"+44 \u001b[7m7123 456789\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"+44 \u001b[7mXXXX XXXXXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"+44 \u001b[7m7123 456789\u001b[27m\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:135:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Phone Numbers should partially redact phone numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact phone numbers"},{"ancestorTitles":["PIIRedactionService","Email Addresses"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Email Addresses should redact email addresses","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should redact email addresses"},{"ancestorTitles":["PIIRedactionService","Email Addresses"],"duration":3,"failureDetails":[{"matcherResult":{"actual":"john.smith@example.com","expected":"jo***@example.com","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"jo\u001b[7m***\u001b[27m@example.com\"\u001b[39m\nReceived: \u001b[31m\"jo\u001b[7mhn.smith\u001b[27m@example.com\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"jo\u001b[7m***\u001b[27m@example.com\"\u001b[39m\nReceived: \u001b[31m\"jo\u001b[7mhn.smith\u001b[27m@example.com\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:150:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Email Addresses should partially redact emails","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact emails"},{"ancestorTitles":["PIIRedactionService","Email Addresses"],"duration":4,"failureDetails":[{"matcherResult":{"actual":"test@example.com","expected":"[EMAIL_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"test@example.com\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"test@example.com\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:162:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:160:18)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Email Addresses should handle multiple email formats","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle multiple email formats"},{"ancestorTitles":["PIIRedactionService","UK Addresses"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"123 [NAME_REDACTED]","expected":"[ADDRESS_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[ADDRESS\u001b[27m_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7m123 [NAME\u001b[27m_REDACTED]\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[ADDRESS\u001b[27m_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7m123 [NAME\u001b[27m_REDACTED]\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:177:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:175:17)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Addresses should redact street addresses","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact street addresses"},{"ancestorTitles":["PIIRedactionService","UK Addresses"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"123 H*** S***","expected":"XX Street","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"XX Street\"\u001b[39m\nReceived: \u001b[31m\"123 H*** S***\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"XX Street\"\u001b[39m\nReceived: \u001b[31m\"123 H*** S***\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:183:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService UK Addresses should partially redact addresses","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact addresses"},{"ancestorTitles":["PIIRedactionService","Financial Information"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Financial Information should redact bank account numbers","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should redact bank account numbers"},{"ancestorTitles":["PIIRedactionService","Financial Information"],"duration":11,"failureDetails":[{"matcherResult":{"actual":"Sort: 123456","expected":"Sort: [SORT_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Sort: \u001b[7m[SORT_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"Sort: \u001b[7m123456\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"Sort: \u001b[7m[SORT_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"Sort: \u001b[7m123456\u001b[27m\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:199:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:197:17)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Financial Information should redact sort codes","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"should redact sort codes"},{"ancestorTitles":["PIIRedactionService","Financial Information"],"duration":4,"failureDetails":[{"matcherResult":{"actual":"1234 5678 9012 3456","expected":"[CARD_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[CARD_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"1234 5678 9012 3456\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[CARD_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"1234 5678 9012 3456\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:212:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:210:19)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Financial Information should redact credit card numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact credit card numbers"},{"ancestorTitles":["PIIRedactionService","Financial Information"],"duration":3,"failureDetails":[{"matcherResult":{"actual":"1234 5678 9012 3456","expected":"XXXX-XXXX-XXXX-3456","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mXXXX-XXXX-XXXX-\u001b[27m3456\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7m1234 5678 9012 \u001b[27m3456\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7mXXXX-XXXX-XXXX-\u001b[27m3456\"\u001b[39m\nReceived: \u001b[31m\"\u001b[7m1234 5678 9012 \u001b[27m3456\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:218:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Financial Information should partially redact financial information","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact financial information"},{"ancestorTitles":["PIIRedactionService","Legal References"],"duration":3,"failureDetails":[{"matcherResult":{"actual":"CASE-123456","expected":"[CASE_REF_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[\u001b[27mCASE\u001b[7m_REF_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"CASE\u001b[7m-123456\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"\u001b[7m[\u001b[27mCASE\u001b[7m_REF_REDACTED]\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"CASE\u001b[7m-123456\u001b[27m\"\u001b[39m\n    at /home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:233:37\n    at Array.forEach (<anonymous>)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:231:16)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Legal References should redact case reference numbers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact case reference numbers"},{"ancestorTitles":["PIIRedactionService","Legal References"],"duration":3,"failureDetails":[{"matcherResult":{"actual":"CASE-123456","expected":"CASE-XXXX","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"CASE-\u001b[7mXXXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"CASE-\u001b[7m123456\u001b[27m\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"CASE-\u001b[7mXXXX\u001b[27m\"\u001b[39m\nReceived: \u001b[31m\"CASE-\u001b[7m123456\u001b[27m\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:239:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Legal References should partially redact case references","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should partially redact case references"},{"ancestorTitles":["PIIRedactionService","Dates of Birth"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Dates of Birth should redact DOB in various formats","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should redact DOB in various formats"},{"ancestorTitles":["PIIRedactionService","JWT Tokens"],"duration":4,"failureDetails":[{"matcherResult":{"actual":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c","expected":"[JWT_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[JWT_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[JWT_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:264:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService JWT Tokens should redact JWT tokens","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact JWT tokens"},{"ancestorTitles":["PIIRedactionService","Object Redaction"],"duration":25,"failureDetails":[{"matcherResult":{"actual":"John Smith","expected":"[NAME_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:288:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Object Redaction should redact PII in nested objects","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact PII in nested objects"},{"ancestorTitles":["PIIRedactionService","Object Redaction"],"duration":15,"failureDetails":[{"matcherResult":{"actual":"John Smith","expected":"[NAME_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:306:40)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Object Redaction should handle arrays in objects","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle arrays in objects"},{"ancestorTitles":["PIIRedactionService","PII Detection"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService PII Detection should detect PII without redacting","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should detect PII without redacting"},{"ancestorTitles":["PIIRedactionService","PII Detection"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService PII Detection should return false for text without PII","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return false for text without PII"},{"ancestorTitles":["PIIRedactionService","Role-based Redaction"],"duration":8,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\nExpected substring: \u001b[32m\"J***\"\u001b[39m\nReceived string:    \u001b[31m\"John Smith email: jo***@example.com\"\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\nExpected substring: \u001b[32m\"J***\"\u001b[39m\nReceived string:    \u001b[31m\"John Smith email: jo***@example.com\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:346:44)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Role-based Redaction should apply different redaction levels based on role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should apply different redaction levels based on role"},{"ancestorTitles":["PIIRedactionService","Custom Rules"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Custom Rules should allow adding custom redaction rules","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow adding custom redaction rules"},{"ancestorTitles":["PIIRedactionService","Custom Rules"],"duration":0,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"already exists\"\u001b[39m\n\nReceived function did not throw","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"already exists\"\u001b[39m\n\nReceived function did not throw\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:406:54)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Custom Rules should prevent duplicate rule IDs","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should prevent duplicate rule IDs"},{"ancestorTitles":["PIIRedactionService","Performance and Edge Cases"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Performance and Edge Cases should handle empty or null input","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle empty or null input"},{"ancestorTitles":["PIIRedactionService","Performance and Edge Cases"],"duration":172,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Performance and Edge Cases should handle reasonably long text efficiently","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle reasonably long text efficiently"},{"ancestorTitles":["PIIRedactionService","Performance and Edge Cases"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\nExpected substring: \u001b[32m\"\u001b[39m\n\u001b[32m\"\u001b[39m\nReceived string:    \u001b[31m\"Client: [NAME_REDACTED]: j[EMAIL_REDACTED]Phone: +[PHONE_REDACTED]\"\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\nExpected substring: \u001b[32m\"\u001b[39m\n\u001b[32m\"\u001b[39m\nReceived string:    \u001b[31m\"Client: [NAME_REDACTED]: j[EMAIL_REDACTED]Phone: +[PHONE_REDACTED]\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:437:35)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Performance and Edge Cases should maintain text structure when preserveFormat is enabled","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should maintain text structure when preserveFormat is enabled"},{"ancestorTitles":["PIIRedactionService","Hash Consistency"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Hash Consistency should generate consistent hashes for same input","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should generate consistent hashes for same input"},{"ancestorTitles":["PIIRedactionService","Hash Consistency"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Hash Consistency should generate different hashes for different inputs","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should generate different hashes for different inputs"},{"ancestorTitles":["PIIRedactionService","Statistics and Monitoring"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService Statistics and Monitoring should provide redaction statistics","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should provide redaction statistics"},{"ancestorTitles":["PIIRedactionService","Statistics and Monitoring"],"duration":5,"failureDetails":[{"matcherResult":{"actual":"john@example.com","expected":"[EMAIL_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"john@example.com\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"john@example.com\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:491:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Statistics and Monitoring should allow enabling/disabling rules","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"failed","title":"should allow enabling/disabling rules"},{"ancestorTitles":["PIIRedactionService","PII Middleware Integration"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService PII Middleware Integration should create logging middleware","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create logging middleware"},{"ancestorTitles":["PIIRedactionService","PII Middleware Integration"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"PIIRedactionService PII Middleware Integration should create error middleware","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should create error middleware"},{"ancestorTitles":["PIIRedactionService","Performance Benchmarks"],"duration":30,"failureDetails":[{"matcherResult":{"actual":"John Smith","expected":"[NAME_REDACTED]","message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m","name":"toBe","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\nReceived: \u001b[31m\"John Smith\"\u001b[39m\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts:531:33)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"PIIRedactionService Performance Benchmarks should process typical case data within acceptable time","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should process typical case data within acceptable time"}],"endTime":1756771836680,"message":"\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Names Redaction  should partially redact names with PARTIAL level\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"Contact J\u001b[7m*** S***\u001b[27m for details.\"\u001b[39m\n    Received: \u001b[31m\"Contact J\u001b[7mohn Smith\u001b[27m for details.\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 31 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(text\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 33 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Contact J*** S*** for details.'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 34 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactionsApplied)\u001b[33m.\u001b[39mtoHaveLength(\u001b[35m1\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 35 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:33:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Names Redaction  should handle multiple names in text\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7m[NAME_REDACTED]\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7mJohn Smith\u001b[27m and [NAME_REDACTED] are co-defendants.\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 47 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(text\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 48 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 49 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NAME_REDACTED] and [NAME_REDACTED] are co-defendants.'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 50 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactionsApplied[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mmatchCount)\u001b[33m.\u001b[39mtoBe(\u001b[35m2\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 51 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 52 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:49:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK National Insurance Numbers  should redact valid NI numbers\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"NI Number: [NI_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"NI Number: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 57 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(text\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 58 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 59 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'NI Number: [NI_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 60 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactionsApplied[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mseverity)\u001b[33m.\u001b[39mtoBe(\u001b[32m'CRITICAL'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 61 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 62 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:59:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK National Insurance Numbers  should handle NI numbers with different spacing\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"NI: [NI_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"NI: [NI\u001b[7m[SORT\u001b[27m_REDACTED]\u001b[7mD]\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 77 |\u001b[39m       testCases\u001b[33m.\u001b[39mforEach(niNumber \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 78 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m`NI: ${niNumber}`\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 79 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'NI: [NI_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 80 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 81 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 82 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:79:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:77:17)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Postcodes  should partially redact postcodes\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"SW\u001b[7mX XXX\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"SW\u001b[7m1A 1AA\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 100 |\u001b[39m     it(\u001b[32m'should partially redact postcodes'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 101 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'SW1A 1AA'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 102 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'SWX XXX'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 103 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 104 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 105 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:102:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Phone Numbers  should redact landline numbers\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"Office: \u001b[7m[PHONE_REDACTED]\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"Office: \u001b[7m+44 20 1234 5678\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 127 |\u001b[39m       testCases\u001b[33m.\u001b[39mforEach(phone \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 128 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m`Office: ${phone}`\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 129 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Office: [PHONE_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 130 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 131 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 132 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:129:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:127:17)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Phone Numbers  should partially redact phone numbers\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"+44 \u001b[7mXXXX XXXXXX\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"+44 \u001b[7m7123 456789\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 133 |\u001b[39m     it(\u001b[32m'should partially redact phone numbers'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 134 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'+44 7123 456789'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 135 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'+44 XXXX XXXXXX'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 136 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 137 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 138 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:135:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Email Addresses  should partially redact emails\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"jo\u001b[7m***\u001b[27m@example.com\"\u001b[39m\n    Received: \u001b[31m\"jo\u001b[7mhn.smith\u001b[27m@example.com\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 148 |\u001b[39m     it(\u001b[32m'should partially redact emails'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 149 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'john.smith@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 150 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'jo***@example.com'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 151 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 152 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 153 |\u001b[39m     it(\u001b[32m'should handle multiple email formats'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:150:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Email Addresses  should handle multiple email formats\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"test@example.com\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 160 |\u001b[39m       testEmails\u001b[33m.\u001b[39mforEach(email \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 161 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(email\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 162 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 163 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 164 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 165 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:162:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:160:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Addresses  should redact street addresses\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7m[ADDRESS\u001b[27m_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7m123 [NAME\u001b[27m_REDACTED]\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 175 |\u001b[39m       addresses\u001b[33m.\u001b[39mforEach(address \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 176 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(address\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 177 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[ADDRESS_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 178 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 179 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 180 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:177:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:175:17)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  UK Addresses  should partially redact addresses\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"XX Street\"\u001b[39m\n    Received: \u001b[31m\"123 H*** S***\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 181 |\u001b[39m     it(\u001b[32m'should partially redact addresses'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 182 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'123 High Street'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 183 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'XX Street'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 184 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 185 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 186 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:183:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Financial Information  should redact sort codes\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"Sort: \u001b[7m[SORT_REDACTED]\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"Sort: \u001b[7m123456\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 197 |\u001b[39m       sortCodes\u001b[33m.\u001b[39mforEach(sortCode \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 198 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m`Sort: ${sortCode}`\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 199 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'Sort: [SORT_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 200 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 201 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 202 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:199:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:197:17)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Financial Information  should redact credit card numbers\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[CARD_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"1234 5678 9012 3456\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 210 |\u001b[39m       cardNumbers\u001b[33m.\u001b[39mforEach(card \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(card\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 212 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[CARD_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 213 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 214 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 215 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:212:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:210:19)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Financial Information  should partially redact financial information\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7mXXXX-XXXX-XXXX-\u001b[27m3456\"\u001b[39m\n    Received: \u001b[31m\"\u001b[7m1234 5678 9012 \u001b[27m3456\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 216 |\u001b[39m     it(\u001b[32m'should partially redact financial information'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 217 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'1234 5678 9012 3456'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 218 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'XXXX-XXXX-XXXX-3456'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 219 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 220 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 221 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:218:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Legal References  should redact case reference numbers\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"\u001b[7m[\u001b[27mCASE\u001b[7m_REF_REDACTED]\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"CASE\u001b[7m-123456\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 231 |\u001b[39m       caseRefs\u001b[33m.\u001b[39mforEach(ref \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 232 |\u001b[39m         \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(ref\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 233 |\u001b[39m         expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[CASE_REF_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 234 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 235 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 236 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:233:37\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m          at Array.forEach (<anonymous>)\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:231:16)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Legal References  should partially redact case references\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"CASE-\u001b[7mXXXX\u001b[27m\"\u001b[39m\n    Received: \u001b[31m\"CASE-\u001b[7m123456\u001b[27m\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 237 |\u001b[39m     it(\u001b[32m'should partially redact case references'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 238 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'CASE-123456'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'solicitor'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mPARTIAL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 239 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'CASE-XXXX'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 240 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 241 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 242 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:239:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  JWT Tokens  should redact JWT tokens\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[JWT_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 262 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(jwt\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 263 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 264 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[JWT_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 265 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactionsApplied[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mseverity)\u001b[33m.\u001b[39mtoBe(\u001b[32m'CRITICAL'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 266 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 267 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:264:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Object Redaction  should redact PII in nested objects\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"John Smith\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 286 |\u001b[39m       \u001b[36mconst\u001b[39m { redacted\u001b[33m,\u001b[39m summary } \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredactObject(testObject\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 287 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 288 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclient\u001b[33m.\u001b[39mname)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NAME_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 289 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclient\u001b[33m.\u001b[39memail)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 290 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclient\u001b[33m.\u001b[39maddress\u001b[33m.\u001b[39mstreet)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[ADDRESS_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 291 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclient\u001b[33m.\u001b[39maddress\u001b[33m.\u001b[39mpostcode)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[POSTCODE_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:288:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Object Redaction  should handle arrays in objects\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"John Smith\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 304 |\u001b[39m       \u001b[36mconst\u001b[39m { redacted } \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredactObject(testObject\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 305 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 306 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclients[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39mname)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NAME_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 307 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclients[\u001b[35m0\u001b[39m]\u001b[33m.\u001b[39memail)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 308 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclients[\u001b[35m1\u001b[39m]\u001b[33m.\u001b[39mname)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NAME_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 309 |\u001b[39m       expect(redacted\u001b[33m.\u001b[39mclients[\u001b[35m1\u001b[39m]\u001b[33m.\u001b[39memail)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:306:40)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Role-based Redaction  should apply different redaction levels based on role\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\n    Expected substring: \u001b[32m\"J***\"\u001b[39m\n    Received string:    \u001b[31m\"John Smith email: jo***@example.com\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 344 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 345 |\u001b[39m       expect(adminResult\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(text)\u001b[33m;\u001b[39m \u001b[90m// No redaction for admin\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 346 |\u001b[39m       expect(solicitorResult\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoContain(\u001b[32m'J***'\u001b[39m)\u001b[33m;\u001b[39m \u001b[90m// Partial redaction\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 347 |\u001b[39m       expect(guestResult\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoContain(\u001b[32m'[NAME_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m \u001b[90m// Full redaction\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 348 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 349 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:346:44)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Custom Rules  should prevent duplicate rule IDs\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"already exists\"\u001b[39m\n\n    Received function did not throw\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 404 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 405 |\u001b[39m       piiRedactor\u001b[33m.\u001b[39maddCustomRule(rule1)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 406 |\u001b[39m       expect(() \u001b[33m=>\u001b[39m piiRedactor\u001b[33m.\u001b[39maddCustomRule(rule2))\u001b[33m.\u001b[39mtoThrow(\u001b[32m'already exists'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 407 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 409 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:406:54)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Performance and Edge Cases  should maintain text structure when preserveFormat is enabled\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoContain\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // indexOf\u001b[22m\n\n    Expected substring: \u001b[32m\"\u001b[39m\n    \u001b[32m\"\u001b[39m\n    Received string:    \u001b[31m\"Client: [NAME_REDACTED]: j[EMAIL_REDACTED]Phone: +[PHONE_REDACTED]\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 435 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(text\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 436 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 437 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoContain(\u001b[32m'\\n'\u001b[39m)\u001b[33m;\u001b[39m \u001b[90m// Should preserve newlines\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                   \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 438 |\u001b[39m       expect(result\u001b[33m.\u001b[39mredactedText\u001b[33m.\u001b[39msplit(\u001b[32m'\\n'\u001b[39m))\u001b[33m.\u001b[39mtoHaveLength(\u001b[35m3\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 439 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 440 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:437:35)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Statistics and Monitoring  should allow enabling/disabling rules\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[EMAIL_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"john@example.com\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 489 |\u001b[39m       \u001b[90m// Test that rule is enabled again\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 490 |\u001b[39m       \u001b[36mconst\u001b[39m result2 \u001b[33m=\u001b[39m piiRedactor\u001b[33m.\u001b[39mredact(\u001b[32m'john@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'guest'\u001b[39m\u001b[33m,\u001b[39m \u001b[33mRedactionLevel\u001b[39m\u001b[33m.\u001b[39m\u001b[33mFULL\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 491 |\u001b[39m       expect(result2\u001b[33m.\u001b[39mredactedText)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 492 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 493 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 494 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:491:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mPIIRedactionService  Performance Benchmarks  should process typical case data within acceptable time\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\n    Expected: \u001b[32m\"[NAME_REDACTED]\"\u001b[39m\n    Received: \u001b[31m\"John Smith\"\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 529 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 530 |\u001b[39m     \u001b[90m// Verify redaction occurred\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 531 |\u001b[39m     expect(redacted\u001b[33m.\u001b[39mclientName)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NAME_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 532 |\u001b[39m     expect(redacted\u001b[33m.\u001b[39mclientEmail)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[EMAIL_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 533 |\u001b[39m     expect(redacted\u001b[33m.\u001b[39mnationalInsurance)\u001b[33m.\u001b[39mtoBe(\u001b[32m'[NI_REDACTED]'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 534 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/pii-redactor.test.ts\u001b[39m\u001b[0m\u001b[2m:531:33)\u001b[22m\u001b[2m\u001b[22m\n","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/pii-redactor.test.ts","startTime":1756771835884,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["RealAIService","constructor"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService constructor should initialize Ollama with default host","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should initialize Ollama with default host"},{"ancestorTitles":["RealAIService","constructor"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService constructor should use custom host from environment","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should use custom host from environment"},{"ancestorTitles":["RealAIService","chat"],"duration":18,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:80:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should send chat message and return response","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should send chat message and return response"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:102:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should use mistral model when specified","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should use mistral model when specified"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:113:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should use legal mode system prompt","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should use legal mode system prompt"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:129:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should use draft mode system prompt","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should use draft mode system prompt"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:145:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should build contextual message with case ID","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should build contextual message with case ID"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:161:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should build contextual message with document ID","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should build contextual message with document ID"},{"ancestorTitles":["RealAIService","chat"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI service temporarily unavailable\n    at RealAIService.chat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:37:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:182:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chat should build contextual message with attached files","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should build contextual message with attached files"},{"ancestorTitles":["RealAIService","chat"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService chat should handle chat errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle chat errors"},{"ancestorTitles":["RealAIService","chatStream"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: AI streaming service temporarily unavailable\n    at RealAIService.chatStream (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:73:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:210:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService chatStream should handle streaming chat","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle streaming chat"},{"ancestorTitles":["RealAIService","chatStream"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService chatStream should handle streaming errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle streaming errors"},{"ancestorTitles":["RealAIService","generateEmbedding"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Embedding generation failed\n    at RealAIService.generateEmbedding (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:128:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:237:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService generateEmbedding should generate embeddings for text","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should generate embeddings for text"},{"ancestorTitles":["RealAIService","generateEmbedding"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService generateEmbedding should handle embedding errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle embedding errors"},{"ancestorTitles":["RealAIService","analyzeDocument"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Document analysis failed\n    at RealAIService.analyzeDocument (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:161:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:261:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService analyzeDocument should analyze document content","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should analyze document content"},{"ancestorTitles":["RealAIService","analyzeDocument"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Document analysis failed\n    at RealAIService.analyzeDocument (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:161:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:282:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService analyzeDocument should truncate long documents","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should truncate long documents"},{"ancestorTitles":["RealAIService","analyzeDocument"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService analyzeDocument should handle analysis errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle analysis errors"},{"ancestorTitles":["RealAIService","generateDraft"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Draft generation failed\n    at RealAIService.generateDraft (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:188:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:312:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService generateDraft should generate document draft","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should generate document draft"},{"ancestorTitles":["RealAIService","generateDraft"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService generateDraft should handle draft generation errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle draft generation errors"},{"ancestorTitles":["RealAIService","summarize"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Summarization failed\n    at RealAIService.summarize (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:208:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:342:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService summarize should summarize text","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should summarize text"},{"ancestorTitles":["RealAIService","summarize"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Summarization failed\n    at RealAIService.summarize (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:208:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:360:21)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService summarize should truncate long text for summarization","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should truncate long text for summarization"},{"ancestorTitles":["RealAIService","summarize"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService summarize should handle summarization errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle summarization errors"},{"ancestorTitles":["RealAIService","listModels"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: Failed to list models\n    at RealAIService.listModels (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/services/real-ai.ts:223:13)\n    at Object.<anonymous> (/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts:387:36)\n    at Promise.then.completed (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:316:40)\n    at _runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/mine/ai/claude-home/projects/solicitor-brain-v2/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"RealAIService listModels should list available models","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should list available models"},{"ancestorTitles":["RealAIService","listModels"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RealAIService listModels should handle list models errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle list models errors"}],"endTime":1756771837682,"message":"\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should send chat message and return response\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:80:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should use mistral model when specified\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:102:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should use legal mode system prompt\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:113:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should use draft mode system prompt\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:129:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should build contextual message with case ID\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:145:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should build contextual message with document ID\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:161:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chat  should build contextual message with attached files\u001b[39m\u001b[22m\n\n    AI service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 35 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 36 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 37 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 40 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chat (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:37:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:182:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  chatStream  should handle streaming chat\u001b[39m\u001b[22m\n\n    AI streaming service temporarily unavailable\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 71 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama streaming chat error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 73 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'AI streaming service temporarily unavailable'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 74 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 75 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 76 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.chatStream (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:73:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:210:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  generateEmbedding  should generate embeddings for text\u001b[39m\u001b[22m\n\n    Embedding generation failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 126 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 127 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Ollama embedding error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 128 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Embedding generation failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 129 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 130 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 131 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.generateEmbedding (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:128:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:237:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  analyzeDocument  should analyze document content\u001b[39m\u001b[22m\n\n    Document analysis failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 159 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 160 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Document analysis error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 161 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Document analysis failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 162 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 163 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 164 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.analyzeDocument (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:161:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:261:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  analyzeDocument  should truncate long documents\u001b[39m\u001b[22m\n\n    Document analysis failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 159 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 160 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Document analysis error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 161 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Document analysis failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 162 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 163 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 164 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.analyzeDocument (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:161:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:282:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  generateDraft  should generate document draft\u001b[39m\u001b[22m\n\n    Draft generation failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 186 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 187 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Draft generation error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 188 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Draft generation failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 189 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 190 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 191 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.generateDraft (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:188:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:312:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  summarize  should summarize text\u001b[39m\u001b[22m\n\n    Summarization failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 206 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 207 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Summarization error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 208 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Summarization failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 209 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 210 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.summarize (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:208:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:342:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  summarize  should truncate long text for summarization\u001b[39m\u001b[22m\n\n    Summarization failed\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 206 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 207 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'Summarization error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 208 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Summarization failed'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 209 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 210 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.summarize (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:208:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:360:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m \u001b[22m\u001b[1mRealAIService  listModels  should list available models\u001b[39m\u001b[22m\n\n    Failed to list models\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 221 |\u001b[39m     } \u001b[36mcatch\u001b[39m (error) {\u001b[22m\n\u001b[2m     \u001b[90m 222 |\u001b[39m       console\u001b[33m.\u001b[39merror(\u001b[32m'List models error:'\u001b[39m\u001b[33m,\u001b[39m error)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 223 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'Failed to list models'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 224 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 225 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat RealAIService.listModels (\u001b[22m\u001b[2mserver/services/real-ai.ts\u001b[2m:223:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mserver/tests/real-ai.test.ts\u001b[39m\u001b[0m\u001b[2m:387:36)\u001b[22m\u001b[2m\u001b[22m\n","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/real-ai.test.ts","startTime":1756771837553,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"adds two numbers","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"adds two numbers"}],"endTime":1756771845563,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/client/src/lib/sum.test.ts","startTime":1756771838084,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["AuthService","hashPassword"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService hashPassword should hash password with correct rounds","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should hash password with correct rounds"},{"ancestorTitles":["AuthService","hashPassword"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"AuthService hashPassword should handle bcrypt errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle bcrypt errors"},{"ancestorTitles":["AuthService","verifyPassword"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService verifyPassword should verify password correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should verify password correctly"},{"ancestorTitles":["AuthService","verifyPassword"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService verifyPassword should return false for invalid password","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return false for invalid password"},{"ancestorTitles":["AuthService","generateToken"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService generateToken should generate JWT token with correct payload","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should generate JWT token with correct payload"},{"ancestorTitles":["AuthService","verifyToken"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService verifyToken should verify and decode JWT token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should verify and decode JWT token"},{"ancestorTitles":["AuthService","verifyToken"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"AuthService verifyToken should throw error for invalid token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error for invalid token"},{"ancestorTitles":["AuthService","register"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService register should register new user successfully","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should register new user successfully"},{"ancestorTitles":["AuthService","register"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService register should throw error if username already exists","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error if username already exists"},{"ancestorTitles":["AuthService","login"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"AuthService login should login user successfully","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should login user successfully"},{"ancestorTitles":["AuthService","login"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService login should throw error for non-existent user","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error for non-existent user"},{"ancestorTitles":["AuthService","login"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService login should throw error for invalid password","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw error for invalid password"},{"ancestorTitles":["AuthService","getUserById"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService getUserById should return user without password","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return user without password"},{"ancestorTitles":["AuthService","getUserById"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService getUserById should return null for non-existent user","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return null for non-existent user"},{"ancestorTitles":["AuthService","updatePassword"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService updatePassword should update user password","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should update user password"},{"ancestorTitles":["AuthService","hasRole"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService hasRole should return true for allowed role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return true for allowed role"},{"ancestorTitles":["AuthService","hasRole"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"AuthService hasRole should return false for disallowed role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return false for disallowed role"}],"endTime":1756771845842,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/auth.test.ts","startTime":1756771845570,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Audit Service","auditLog"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should create audit log entry with redacted sensitive data","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should create audit log entry with redacted sensitive data"},{"ancestorTitles":["Audit Service","auditLog"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should handle null metadata","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle null metadata"},{"ancestorTitles":["Audit Service","auditLog"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should handle empty metadata object","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle empty metadata object"},{"ancestorTitles":["Audit Service","auditLog"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should redact case-insensitive field names","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should redact case-insensitive field names"},{"ancestorTitles":["Audit Service","auditLog"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should redact partial field name matches","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should redact partial field name matches"},{"ancestorTitles":["Audit Service","auditLog"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should handle nested objects","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle nested objects"},{"ancestorTitles":["Audit Service","auditLog"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should handle arrays in metadata","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle arrays in metadata"},{"ancestorTitles":["Audit Service","auditLog"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service auditLog should handle database errors gracefully","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle database errors gracefully"},{"ancestorTitles":["Audit Service","getAuditLogs"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service getAuditLogs should return audit logs with default pagination","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should return audit logs with default pagination"},{"ancestorTitles":["Audit Service","getAuditLogs"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service getAuditLogs should apply custom pagination","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should apply custom pagination"},{"ancestorTitles":["Audit Service","getAuditLogs"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service getAuditLogs should handle database errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle database errors"},{"ancestorTitles":["Audit Service","redactSensitiveData function"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service redactSensitiveData function should handle primitive values","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle primitive values"},{"ancestorTitles":["Audit Service","redactSensitiveData function"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Audit Service redactSensitiveData function should handle complex nested structures","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle complex nested structures"}],"endTime":1756771846010,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/audit.test.ts","startTime":1756771845846,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["AuthService Import Test"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"AuthService Import Test should import AuthService successfully","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should import AuthService successfully"}],"endTime":1756771846084,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/auth-import.test.ts","startTime":1756771846015,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["API Sanity"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"API Sanity should pass a basic test","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should pass a basic test"}],"endTime":1756771846118,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/sanity.test.ts","startTime":1756771846088,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["test"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"test passes","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"passes"}],"endTime":1756771846146,"message":"","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/server/tests/simple.test.ts","startTime":1756771846121,"status":"passed","summary":""},{"assertionResults":[],"coverage":{},"endTime":1756771846309,"message":"  \u001b[1m \u001b[22mTest suite failed to run\n\n    \u001b[1m\u001b[31mJest encountered an unexpected token\u001b[39m\u001b[22m\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n      If you are trying to use ECMAScript Modules, see \u001b[4mhttps://jestjs.io/docs/ecmascript-modules\u001b[24m for how to enable it.\n      If you are trying to use TypeScript, see \u001b[4mhttps://jestjs.io/docs/getting-started#using-typescript\u001b[24m\n      To have some of your \"node_modules\" files transformed, you can specify a custom \u001b[1m\"transformIgnorePatterns\"\u001b[22m in your config.\n      If you need a custom transformation specify a \u001b[1m\"transform\"\u001b[22m option in your config.\n      If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \u001b[1m\"moduleNameMapper\"\u001b[22m config option.\n\n    You'll find more details and examples of these config options in the docs:\n    \u001b[36mhttps://jestjs.io/docs/configuration\u001b[39m\n    For information about custom transformations, see:\n    \u001b[36mhttps://jestjs.io/docs/code-transformation\u001b[39m\n\n    \u001b[1m\u001b[31mDetails:\u001b[39m\u001b[22m\n\n    /home/mine/ai/claude-home/projects/solicitor-brain-v2/client/src/components/__tests__/AIChatPanel.test.tsx:24\n            (0, react_2.render)(<AIChatPanel_1.AIChatPanel onDocumentAnalyze={mockOnDocumentAnalyze}/>);\n                                ^\n\n    SyntaxError: Unexpected token '<'\n\n      \u001b[2mat Runtime.createScriptFromCode (\u001b[22mnode_modules/jest-runtime/build/index.js\u001b[2m:1505:14)\u001b[22m\n","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/client/src/components/__tests__/AIChatPanel.test.tsx","startTime":1756771846309,"status":"failed","summary":""},{"assertionResults":[],"coverage":{},"endTime":1756771846309,"message":"  \u001b[1m \u001b[22mTest suite failed to run\n\n    \u001b[1m\u001b[31mJest encountered an unexpected token\u001b[39m\u001b[22m\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n      If you are trying to use ECMAScript Modules, see \u001b[4mhttps://jestjs.io/docs/ecmascript-modules\u001b[24m for how to enable it.\n      If you are trying to use TypeScript, see \u001b[4mhttps://jestjs.io/docs/getting-started#using-typescript\u001b[24m\n      To have some of your \"node_modules\" files transformed, you can specify a custom \u001b[1m\"transformIgnorePatterns\"\u001b[22m in your config.\n      If you need a custom transformation specify a \u001b[1m\"transform\"\u001b[22m option in your config.\n      If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \u001b[1m\"moduleNameMapper\"\u001b[22m config option.\n\n    You'll find more details and examples of these config options in the docs:\n    \u001b[36mhttps://jestjs.io/docs/configuration\u001b[39m\n    For information about custom transformations, see:\n    \u001b[36mhttps://jestjs.io/docs/code-transformation\u001b[39m\n\n    \u001b[1m\u001b[31mDetails:\u001b[39m\u001b[22m\n\n    /home/mine/ai/claude-home/projects/solicitor-brain-v2/client/src/App.test.tsx:8\n        Switch: ({ children }) => <div>{children}</div>,\n                                  ^\n\n    SyntaxError: Unexpected token '<'\n\n      \u001b[2mat Runtime.createScriptFromCode (\u001b[22mnode_modules/jest-runtime/build/index.js\u001b[2m:1505:14)\u001b[22m\n","name":"/home/mine/ai/claude-home/projects/solicitor-brain-v2/client/src/App.test.tsx","startTime":1756771846309,"status":"failed","summary":""}],"wasInterrupted":false}
